<mat-form-field appearance="outline" class="workspace-switcher">
  <mat-label>Workspace</mat-label>
  <mat-icon matPrefix>workspaces</mat-icon>

  <mat-select
    [value]="workspaceStore.currentWorkspace()?.id ?? null"
    (selectionChange)="onWorkspaceChange($event.value)"
    placeholder="Select workspace">
    @for (group of workspaceGroups(); track group.label) {
      <mat-optgroup [label]="group.label">
        @for (workspace of group.workspaces; track workspace.id.getValue()) {
          <mat-option [value]="workspace.id.getValue()" class="workspace-option">
            <div class="workspace-option-content">
              <mat-icon class="workspace-icon">{{ group.icon }}</mat-icon>
              <span class="workspace-name">{{ workspace.name.getValue() }}</span>
              <mat-chip
                class="status-chip"
                [color]="getStatusColor(workspace.status.getValue())">
                {{ getStatusLabel(workspace.status.getValue()) }}
              </mat-chip>
            </div>
          </mat-option>
        }
      </mat-optgroup>
    }

    @if (workspaceGroups().length === 0) {
      <mat-option disabled>
        <div class="empty-state">
          <mat-icon>workspaces_outline</mat-icon>
          <span>No workspaces available</span>
        </div>
      </mat-option>
    }
  </mat-select>
</mat-form-field>
